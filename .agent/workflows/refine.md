---
description: 構造・内容・戦略・整合性の包括的・破壊的リファイン（厳格モード）
---

# /refine — 包括的マスターワークフロー（STRICT）

`furuyoni_master` スキルの全ペルソナ（Inspector, Navigator, Hajime, Kenshin, Ruri, Sensei, Meijin）を統合し、ドキュメントの品質と整合性を極限まで高める。

**厳格ルール**: 画像重複、リンク切れ、構造エラーは**一切許容しない**。すべての検証で失敗した場合、修正するまでビルドを通さない。

## 手順

1. **多角的監査 (Multi-Pass Audit)**
    - `.agent/skills/furuyoni_master/SKILL.md` を読み込み、全7ペルソナを適用して対象ファイルを批評する。
    - 指摘事項を統合し、具体的かつ最小限の修正案（diff形式）を生成する。

2. **自動メンテナンス (Auto-Fix)**
    // turbo
    - `npx ts-node src/main.ts fix` を実行し、リンク切れ修正、カード名同期、アセット更新、アンカー付与を一括適用する。

3. **構造整合性検証 (Structural Audit) — STRICT**
    // turbo
    - `npx ts-node src/main.ts audit` を実行し、以下を**厳格に検証**:
        - ヘッダー構造（H1は1つ、レベルスキップ禁止）
        - ナビゲーション（孤立ファイル禁止）
        - リンク・画像の存在確認（内部リンク、アンカー、画像パス）
        - **画像の過剰な重複（同一画像3回以上 = ビルド失敗）**
        - **トップページからの導線（`hero-section`, `dashboard-grid` 必須）**
    - **失敗時は即座に中断。修正するまで次のステップに進まない。**

4. **ビルド検証 (Build Verification) — STRICT**
    // turbo
    - `uv run mkdocs build --strict` でサイト全体のビルドが正常であることを確認する。
    - **警告も許容しない。すべてのwarningを解消する。**
    - 画像が正しく表示されているか、トップページ (`index.md`) のヒーローセクションやカードのリンクが壊れていないかを目視またはログで再確認する。

5. **適用と報告**
    - 全修正内容を `notify_user` で提示し、承認後に確定させる。
    - **厳格モードの結果**: すべての検証をパスした場合のみ成功とみなす。
